# devops-netology
first rewrite

В terraform/.gitignore сделаны исключения для:
    1. любых файлов с именем .terraform в любом месте репозитория
    2. файлов с расширениями: *.tfstate,*.tfvars
    3. для файлов с именем crash.log начинающихся на crash.(любые символы).log
    4. отдельные файлы override.tf, override.tf.json, .terraformrc, terraform.rc
    5. файлов заканчивающихся на *_override.tf, *_override.tf.json

#Виртуализация
1. Отличие аппаратной вирутуализации, паравиртуализации и виртуализации на основе ОС.
    Аппаратная виртуализация:
      - основана на использовании гипервизороа, работающего на аппаратном уровне
      - каждая виртуальная машина может иметь собственную ОС
      - виртуальные машины полностью изолированы от друга
    Паравиртуализация:
      - модификация операционноый системы гостевых виртуальных машин
      - гостевые виртуальные машины взаимодействуют с гипервизором через специальный интерфейс, который позволяет эффективное использование аппаратных ресурсов сервера.
    Вирутуализация на основе ОС:
      - реализация на основе контейнеров, работающих на уровне операционной системы
      - контейнеры изолированы друг от друга, но работают но одной операционной системе хоста
      - контейнеры легковесны и быстросоздаваемы
      - эффективное использование ресурсов.нео

2. Варианты использования организации физических серверов:
    Высоконагруженная база данных, чувствительная к отказу - 
    Различные web-приложения - виртуализация на основе ОС(docker, kubernets):
      - обеспечивается изоляция приложений
      - легкая масштабируемость
      - просто управлнение
    Windows-системы для использования бухгалтерским отделом - паравиртуализация(гипервизор VMware/Hyper-V):
      - позволяют виртуализировать всю операционную систему, обеспечивая полную изоляцию и масштабируемость
      - Поддержка резервирования и воссстановления

3. Выбор подходящей системы управления виртуализации:
    1. VMWare Vsphere - система управоением виртуализацией. Поддержка как Linux, так и windows-систем. Возможность создания ВМ с разными ОС, где возможно настроить балансировку нагрузки и репликацию данных. VMWare vSphere поддерживает инструмент создания резервных копий.
    2. KVM является технологией виртуализации, интегрированной в ядро Linux. Он представляет собой гипервизор, который позволяет запускать несколько ВМ с различными операционными системами на одном физическом сервере. KVM также имеет высокую производительность и поддерживает аппаратную виртуализацию.
    3. Microsoft Hyper-V Server. Высокая производительность и поддержка основных функций виртуализации - создание, управеление, баласнировка нагрузки, конфигурирование сетевых настроек. Совместимость с продуктами Windows-инфраструктуры
    4. VirtualBox -  кросс-платформенное open-source решение. Возможность создание и запуска ВМ различных ОС, имеются различные возможности для конфигрирования ВМ(общие папки, различные варианты сетей и т.д.)

4. Проблемы гетерогенной среды виртуализации:
    - Проблема сложности управления различными системами виртуализации, т.к. каждая система  имеет свои собственные особенности администрирования.
    - Неэффективное использование вычислительных ресурсов из-за чего снижение производительности.
    - проблема совместимости ВМ из-за использования различных форматов

    Для минимизации рисков и проблем в гетерогенной среде:
     - необходимо сделать требование по согласованности настроек и параметров между разными системами виртуализаций. 
     - Автоматизированное управление системами виртуализации для того, чтобы настроки не рассходились. Использование инструментов управления множеством систем виртуализации (Multi-Hypervisor Management Tools) может быть полезным в этом случае
    
    Если бы у меня был выбор, я бы предпочел избегать гетерогенной среды виртуализации в пользу одной системы управления виртуализацией. Это позволит упростить управление и обеспечить более эффективное использование вычислительных ресурсов. Однако, если использования избежать нельзя, необзодимо оценить все риски и предпринять все меры заблоговременноо до внедрения такой инфратруктуры

#Принципы IaaC в работе с виртуальными машинами
  1. Основные преимущества применения на практике IaaC-паттернов:
    - позволяет автоматизировать процесс создания и управления инфрастурктурой, что снижает вероятность ошибки связанного с человеческим фактором
    - быстрая и легкая масштабируемость инфраструктуры: удаление, добавление ресурсов в зависимости от требований задачи.
    - перенос системы  на новые сервера
    - Простое изменение настроек текущей инфраструктуры
  
  2. Преимущества Ansible:
    - ахитекутра без использования агента(метод pull) - упрощает первичную настройку и снижает нагрузку за обновлением/поддержанием агентов
    - простоый язык yaml, что дает низкий порог входа
    - поддерживает параллельное выполнение задач на множестве систем
    Метод pull можно считать более надежным, т.к. тут меньше точек отказа - в ахритектуре отсутсвует агент. Но метод стоит выбирать исходя от задачи
  
  3. 
  ```sh
  borusman@netology-test:~$ vboxmanage -v
  6.1.38_Ubuntur153438
  borusman@netology-test:~$ vagrant -v
  Vagrant 2.2.19
  borusman@netology-test:~$ ansible --version
  ansible 2.10.8
    config file = None
    configured module search path = ['/home/borusman/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
    ansible python module location = /usr/lib/python3/dist-packages/ansible
    executable location = /usr/bin/ansible
    python version = 3.10.12 (main, Jun 11 2023, 05:26:28) [GCC 11.4.0]
    borusman@netology-test:~$ terraform --version
  Terraform v1.5.6
  on linux_amd64
  ```
  4.
  ```sh
  vagrant@server1:~$ docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
  ```
#Жизненный цикл Docker-контейнера 

  1. https://hub.docker.com/r/borusman/devops-netology/tags
  2. Вариант использования виртуализации:
  
    a. высоконагруженное монолитное Java веб-приложение: виртуальная машина, так как требуется выделение ресурсов и сложная настройка окружения
    b. Nodejs веб-приложение: возможен вариант использования docker, не требуется тяжелых ресурсов, легко масщтабировать при помощи docker контейнеров 
    c. мобильное приложение c версиями для Android и iOS: требуется эмулятор мобильных приложений, лучше использовать виртуальную/физическую машину
    d. шина данных на базе Apache Kafka: необходима работа приложения в кластере, подходит вариант использования на виртуальных машинах. Но так же возможен вариант и с запуском в docker(docker-compose), проблема запуска в докер - сложно администрировать кафку в таком случае
    e. Elasticsearch-кластер для реализации логирования продуктивного веб-приложения — три ноды elasticsearch, два logstash и две ноды kibana: запуск через докер, оптимальное решение, после запуска не требуется вмешательств в логику работы,легко разварачивать и поддерживать такую инфраструктур в докере
    f. мониторинг-стек на базе Prometheus и Grafana: легкий и быстрый запуск в докере
    g. MongoDB как основное хранилище данных для Java-приложения: в зависимости от нагрузки, для тяжелых приложений рекомендовано использовать ВМ, т.к. легче выделять ресурсы. Для  легковесных приложений оптимален вариант и с docker.
    h. Gitlab-сервер для реализации CI/CD-процессов и приватный (закрытый) Docker Registry: могут быть развернуты как Docker-контейнеры,

  3. 
      ## Получение образа и запуск контейнера
      ```sh
      docker pull centos && docker run -d centos -v ./data:/data
      docker pull debian && docker run -d debian -v ./data:/data
      ```
      ## Добавление файла в интерактивном режиме для контейнера centos
      ```sh
      docker exec -it container_id sh
      cd /data
      echo "Hello" > hello.txt
      exit
      ```
      ## Добавление файла на хостовой машине
      ```sh
      cd /opt/data
      echo "Hello from host machine" > host.txt
      ```
      ## Отображение файлов для debian
      ```sh
      ls -la /data/
      # ls -la
      total 16
      drwxr-xr-x 2 root root 4096 Aug 28 20:14 .
      drwxr-xr-x 1 root root 4096 Aug 28 20:12 ..
      -rw-r--r-- 1 root root    6 Aug 28 20:13 hello.txt
      -rw-r--r-- 1 root root   24 Aug 28 20:14 host.txt
      ```
4. https://hub.docker.com/layers/borusman/netology-ansible/1.2/images/sha256-05962d8e33186668a0e3049658ca6483471a758ec49d78f8390fa395c18257bc?context=repo
 по выполнению возникла проблема совеместимости пакетов, пришлось добавить  pip3 install --ignore-installed mitogen ansible-lint jmespath && 
